
For any justified sequence of moves $u$, we write $?(u)$ for the subsequence of $u$ consisting of the questions in the sequence $u$ that are still pending at the end of the sequence.

Let $L$ be the following language $L = \{\ p^i q^i\ | \ i \in I_1 \}$.
We consider the following cases:

\begin{center}
\begin{tabular}{c|c|l|l}
Case & $\lambda_{OP}(m)$ & $?(u) \in$ & condition \\ \hline
0 & O & $\{ \epsilon \}$ \\
A & P & $q$ \\
B & O & $q \cdot L^* \cdot p^i$     & $i \in I_1$ \\
C & P & $q \cdot L^* \cdot p^i q^i$ & $i \in I_1$ \\
D & O & $q \cdot L^* \cdot q^i$      & $i \in I_0$ \\
\end{tabular}
\end{center}

We use the notation $\hat{s}$ to denote a legal and well-bracketed \emph{justified} sequence of moves and
$s$ to denote the same sequence of moves with pointers removed.

Note that the well-bracketing condition already tells us how to uniquely recover
the pointers for P answer moves: a P-answers points
to the last pending question having the same tag. However for O answers, we will see that the visibility condition
already ensures the unique recoverability of the pointer and that the well-bracketing condition is not needed.


We prove by induction on the sequence of moves $u$ that $?(u)$ corresponds to either
case 0, A, B, C or D and that the pointers in $u$ can be recovered uniquely.

\textbf{Base cases:}

If $u$ is the empty sequence $\epsilon$ then there is no pointer to recover and it corresponds to case 0.

If $u$ is a singleton then it must be the initial question $q$ and there is not pointer to recover. This corresponds
to case A.

\textbf{Step case:}

Consider a legal well-bracketed justified sequence $\hat{s}$ where $s = u \cdot m$ and $m \in M_A$.
The induction hypothesis tells us
that the pointers of $u$ can be recovered (and therefore the P-view or O-view at that point can be
computed) and that $u$ corresponds to one of the cases 0,A,B,C or D.

We proceed by case analysis on $u$:

\begin{description}

\item[case 0] This case cannot happen because $?(u) = \epsilon$ ($u$ is a complete play) implies that there cannot be any further move $m$.

Indeed the visibility condition implies that $m$ must point to
a P-question in the O-view at that point. But since $u$ is a complete play, the O-view is $\oview{\hat{u}} = q a$ which
does not contain any P-question. Hence the move $m$ cannot be justified and is not valid.


\item[case A] $?(u) = q$ and the last move $m$ is played by P.
    There are several cases:
    \begin{itemize}
    \item $m$ is an answer $a_k$ (to the initial question
    $q$) for some $k$, then $m$ points to $q$:

    $\hat{s} = \justseq{ q & \ldots & m \pointto{ll}}$

    and $?(s) = \epsilon$ therefore $s$ correspond to the case 0 (complete play).

    \item $m = q^i$ where $q^i$ is an order 0 question ($i \in I_0$).
    Then $q^i$ points to the initial question $q$ and $s$ falls into category D.

    \item $m = p^i$, a first order question, then $p^i$ points to $q$,

    $?(s)= q p^i$ and it is O's turn after $s$ therefore $s$ falls into category B.

    \end{itemize}


\item[case B] $?(u) \in q \cdot L^* \cdot p^i$ where $i \in I_1$ and O plays the move $m$.

We now analyse the different possible O-moves:
\begin{itemize}
\item Suppose that O gives the (tagged) answer $b^j$ for some $j \in I_1$ then
the visibility condition constraints it to point to a question in the O-view at that point.

We remark that the last move in $\hat{u}$ must be $p^i$.
Indeed, suppose that there is a move $x \in M_A$ such that $\hat{u} = \justseq{q & \ldots & p^i\ x \pointto{ll}}$
then by visibility, the O-move $x$ should points to a move in the O-view a that point. The O-view is $q p^i$, therefore $x$ can only points to
$p^i$. But then, $p^i$ is not a pending question in $s$ which is a contradiction.


Therefore $\oview{\hat{u}} = \oview{ \justseq{ q & \ldots & p^i \pointto{ll}} } = q p^i$.

Hence $b^j$ can only point to $p^i$ (and therefore $i=j$).

We then have $?(s) = ?(u \cdot b^i) \in  q \cdot L^*$ which is covered by case A and C.

\item The only other possible O-move is $q^i$ which, again by the visibility condition, points necessarily
to the previous move $p^i$.
We then have $?(s) = ?(u \cdot q^i) \in   q \cdot L^* \cdot p^i q^i$. This falls into category C.

\end{itemize}

\item[case C] $?(u) \in q \cdot L^* \cdot p^i q^i$ where $i \in I_1$ and the move $m$ is played by $P$.

Suppose $m$ is an answer, then the well-bracketing condition imposes to answer to $q^i$ first.
The move $m$ is therefore an integer $a^i$ pointing to $q^i$.
We then have $?(s) = ?(u \cdot a^i) \in  q \cdot L^* \cdot p^i$. This correspond to case B.


Suppose $m$ is a question then there are two cases:
\begin{itemize}
\item $m = q^j$ with $j \in I_0$, the pointer goes to the initial question $q$ and $s$ falls into category D.
\item $m = p^j$ with $j \in I_1$, the pointer goes to the initial question $q$ and $s$ falls into category B.
\end{itemize}

\item[case D] $?(u) \in q \cdot L^* \cdot q^i$ where $i \in I_0$ and the move $m$ is played by $O$.

    The same argument as in case B holds. However there is now another possible move:
    the answer $m = a^i_k$ for some $k$.  This moves can only points to
    $q^i$ (this is the only pending question tagged by $i \in I_0$).

    Then $?(\hat{s}) = ?(\hat{u}\cdot a^i_k) = ?(\justseq{ q & \ldots & q^i \pointto{ll} & \ldots & a^i_k \pointto{ll}}) \in q \cdot L^* $ therefore $s$ falls either into category A or C.

\end{description}

This completes the induction.

How to generalize the proof to arenas that have multiple roots (forest arenas)? Well in fact there is no
ambiguity since all the moves are implicitly tagged according to the arena that they belong to. Therefore in the induction, it suffices
to ignore the moves that belong to another tree (as if they were part of a different game played in parallel).
